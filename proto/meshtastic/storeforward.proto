syntax = "proto3";

package meshtastic;

option java_package = "com.geeksville.mesh";
option java_outer_classname = "StoreAndForward";

message StoreAndForward {
    enum RequestResponse {
        UNSET = 0;
        ROUTER_ERROR = 1;
        ROUTER_HEARTBEAT = 2;
        ROUTER_PING = 3;
        ROUTER_PONG = 4;
        ROUTER_BUSY = 5;
        ROUTER_HISTORY = 6;
        ROUTER_STATS = 7;
        ROUTER_TEXT_DIRECT = 8;
        ROUTER_TEXT_BROADCAST = 9;
        CLIENT_ERROR = 64;
        CLIENT_HISTORY = 65;
        CLIENT_STATS = 66;
        CLIENT_PING = 67;
        CLIENT_PONG = 68;
        CLIENT_ABORT = 106;
    }

    message Statistics {
        uint32 messages_total = 1;
        uint32 messages_saved = 2;
        uint32 messages_max = 3;
        uint32 up_time = 4;
        uint32 requests = 5;
        uint32 requests_history = 6;
        bool heartbeat = 7;
        uint32 return_max = 8;
        uint32 return_window = 9;
    }

    message History {
        uint32 history_messages = 1;
        uint32 window = 2;
        uint32 last_request = 3;
    }

    message Heartbeat {
        uint32 period = 1;
        uint32 secondary = 2;
    }

    RequestResponse rr = 1;

    oneof variant {
        Statistics stats = 2;
        History history = 3;
        Heartbeat heartbeat = 4;
        bytes text = 5;
    }
}
